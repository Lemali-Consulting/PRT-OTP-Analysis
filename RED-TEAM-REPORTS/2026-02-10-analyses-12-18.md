# Red-Team Report: Analyses 12–18

**Date:** 2026-02-10
**Scope:** Analyses 12 (Geographic Span), 13 (Correlation Clustering), 14 (COVID Recovery), 15 (Municipal Equity), 16 (Transfer Hub Performance), 17 (Weekend/Weekday Profile), 18 (Multivariate Model)
**Protocol:** [docs/RED-TEAM.md](../docs/RED-TEAM.md)

---

## Summary

30+ issues identified across 7 analyses. 10 significant, 9 moderate, 3 minor. All fixable issues have been resolved in code and analyses rerun. Three findings changed materially (analyses 13, 14, 16), two changed in magnitude (12, 18), and two were unchanged (15, 17). The most consequential fix was the retraction of the "hub penalty" finding in Analysis 16 after correcting for non-independent observations.

---

## Issues Found and Fixes Applied

### Analysis 12: Geographic Span vs OTP

| # | Severity | Issue | Fix | Impact |
|---|----------|-------|-----|--------|
| 1 | Significant | Headline r = -0.32 pools all modes (Simpson's paradox). Chart label used all-mode r but drew bus-only trend line. | Bus-only Pearson/Spearman are now primary. Chart label fixed to show bus-only r. | Bus-only r = -0.38 (stronger). Direction unchanged. |
| 2 | Moderate | No min-month filter on avg OTP. | Added `HAVING COUNT(*) >= 12`. | Removes unreliable short-history routes. |
| 3 | Moderate | METHODS.md promises Spearman; code only computed Pearson. | Added Spearman (rho = -0.37, p < 0.001). | Confirms robustness to outliers. |
| 4 | Minor | Max pairwise Haversine is a noisy proxy for actual route length. | Documented. No fix without GTFS shapefiles. | — |

### Analysis 13: Cross-Route Correlation Clustering

| # | Severity | Issue | Fix | Impact |
|---|----------|-------|-----|--------|
| 5 | Significant | System-wide trend not removed. Clusters dominated by COVID response. | Detrend by subtracting system-wide monthly mean OTP before computing correlations. | Cluster composition changed entirely. |
| 6 | Significant | Imputing 0.0 for insufficient-overlap pairs creates spurious structure. | Impute with median observed correlation. Report count of imputed pairs. | Eliminates artificial tightening of clusters. |
| 7 | Moderate | Ward's method requires Euclidean distance; 1-r is not Euclidean. | Switched to average linkage. | Valid for non-Euclidean distances. |
| 8 | Moderate | k=6 hardcoded without justification. | Silhouette score optimization over k=3–10. | k=6 retained (now empirically justified, silhouette=0.178). |
| 9 | Minor | Modes pooled; ~3 rail routes cannot be stratified. | Documented. | — |

### Analysis 14: COVID Recovery Trajectories

| # | Severity | Issue | Fix | Impact |
|---|----------|-------|-----|--------|
| 10 | Significant | Regression to the mean untested. Extreme movers likely regressing. | Added Pearson correlation (baseline vs. delta). | **r = -0.25, p = 0.02** — significant RTM. Narrative changed from "premium routes recovered better" to "RTM explains much of the divergence." |
| 11 | Significant | No statistical test for subtype differences. | Added Kruskal-Wallis test. | **H = 5.5, p = 0.24** — not significant. "Premium routes recovered better" claim does not survive testing. |
| 12 | Moderate | Current-period months not printed; analysis not reproducible. | Print period start/end. | Reproducibility improved. |

### Analysis 15: Municipal Equity

| # | Severity | Issue | Fix | Impact |
|---|----------|-------|-----|--------|
| 13 | Significant | Ecological fallacy: route OTP → stops → municipalities. | Inherent to data. Documented in FINDINGS.md caveats. | — |
| 14 | Significant | Static trip weights across multi-year period. | Inherent to data. Documented. | — |
| 15 | Moderate | Default equal-variance t-test for unequal groups. | Welch's t-test (`equal_var=False`). | p = 0.86 (negligible change). |

### Analysis 16: Transfer Hub Performance

| # | Severity | Issue | Fix | Impact |
|---|----------|-------|-----|--------|
| 16 | Significant | Stop-level correlation (n=6,209) treats non-independent observations as independent. Effective n ≈ 90. | Added route-level aggregation (mean stop connectivity per route vs. route OTP) as primary metric. | **Finding retracted.** Route-level r = -0.15, p = 0.16 (not significant). Bus-only r = -0.09, p = 0.39. |
| 17 | Significant | Ecological fallacy: route OTP projected onto stops. | Inherent to data. Documented. Route-level analysis used as primary. | — |
| 18 | Moderate | Simpson's paradox from pooling modes. | Added bus-only stratification. | Bus-only r = -0.09 (weaker than pooled). |

### Analysis 17: Weekend/Weekday Service Profile

| # | Severity | Issue | Fix | Impact |
|---|----------|-------|-----|--------|
| 19 | Moderate | Pooled-mode correlation. | Added bus-only correlation. | r = -0.06, p = 0.56. Still null. |
| 20 | Moderate | Monthly OTP conflates weekday/weekend — interpretation overclaims. | Strengthened FINDINGS.md caveats. | — |

### Analysis 18: Multivariate OTP Model

| # | Severity | Issue | Fix | Impact |
|---|----------|-------|-----|--------|
| 21 | Significant | No VIF check for multicollinearity. | Computed VIF for all predictors. | All VIF < 3 (moderate, not severe). |
| 22 | Significant | n_munis suppressor misleadingly interpreted as positive effect. | Report reduced model (without n_munis) alongside full model. Label n_munis as suppressor. | Full R² = 0.47, reduced R² = 0.40. Suppressor role made explicit. |
| 23 | Significant | `np.linalg.inv` numerically unstable. | Switched to `np.linalg.lstsq` + `np.linalg.pinv`. | Numerical robustness improved. |
| 24 | Moderate | is_rail estimated from ~3 observations. | Documented. Added bus-only model as secondary output. | Bus-only R² = 0.38 (no rail dummy needed). |

---

## Findings Impact Summary

### Retracted or Materially Changed

1. **Analysis 16 — "Hub penalty"**: Retracted. The stop-level correlation (r = -0.17, p < 0.001) was an artifact of inflated sample size. Route-level: r = -0.15, p = 0.16.

2. **Analysis 14 — "Premium routes recovered better"**: Changed to "regression to the mean explains a significant portion; no statistically significant subtype difference (Kruskal-Wallis p = 0.24)." The policy-relevant finding narrowed to specific eastern-corridor local bus routes.

3. **Analysis 13 — Cluster composition**: All clusters changed after detrending. The new clusters reflect genuine route-specific co-movement rather than differential COVID response.

### Changed in Magnitude

4. **Analysis 12 — Geographic span correlation**: Bus-only r = -0.38 (was r = -0.32 pooled). Simpson's paradox was *muting* the finding. Partial correlations show stop count has roughly twice the effect of span.

5. **Analysis 18 — Model R²**: Full model R² = 0.47 (unchanged), but reduced model R² = 0.40 reveals the n_munis suppressor contributes ~7 pp of explained variance. Bus-only R² = 0.38 confirms findings generalize within the dominant mode.

### Unchanged

6. **Analysis 15 — Municipal equity**: Welch's t-test p = 0.86 (was ~0.85). No material change.

7. **Analysis 17 — Weekend/weekday null result**: Bus-only r = -0.06 (was r = -0.03 pooled). Still null.

---

## Root FINDINGS.md Changes

The following sections of the root `FINDINGS.md` were updated to reflect corrected results:

- **Section 12**: Bus-only correlations now primary (r = -0.38). Partial correlation results added.
- **Section 13**: Detrending methodology noted. Silhouette score reported.
- **Section 14**: RTM finding (r = -0.25, p = 0.02) added. Kruskal-Wallis (p = 0.24) added. Narrative shifted.
- **Section 16**: Route-level correlation (r = -0.15, p = 0.16) now primary. "Hub penalty" described as composition effect.
- **Key Takeaway #6**: Added RTM caveat.
- **Key Takeaway #8**: Clarified hub penalty does not survive route-level analysis.

---

## Cross-Cutting Lessons

1. **Always stratify by mode.** Five of seven analyses required bus-only analysis to avoid Simpson's paradox or mode-driven artifacts.

2. **Check the unit of analysis.** Stop-level correlations with route-level OTP inflate sample sizes by 60–70x. Route-level aggregation is the correct unit when OTP is measured at the route-month level.

3. **Test for regression to the mean** in any before/after comparison. It is the default explanation for extreme movers.

4. **Report statistical tests for group differences.** Qualitative observations about "premium vs. local" are not sufficient — Kruskal-Wallis or similar tests are needed.

5. **Validate linkage and imputation choices** in clustering analyses. Ward's method with non-Euclidean distances and zero-imputation for missing pairs can produce entirely spurious clusters.
